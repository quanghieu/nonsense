ARM					:= 1
DEBUG_MSG			:= 1
MODULE				:= 1
HELPER				:= 1

EXTRA_CFLAGS		+= -Wframe-larger-than=8192 -include chelp.h
EXTRA_CFLAGS		+= -DNO_FILE_BACKED_NV

ifeq ($(ARM), 1)
EXTRA_CFLAGS		+= -D_ARM_
endif

ifeq ($(DEBUG_MSG), 1)
EXTRA_CFLAGS		+= -DDEBUG_MSG
endif

ifeq ($(MODULE), 1)
ifeq ($(ARM), 1)
export ARCH=arm
export CROSS_COMPILE=arm-linux-gnueabihf-
KERNEL_BUILD		:= /home/youngsup/odroid/odroidxu4-v4.2-rc1
else
KERNEL_RELEASE		:= $(shell uname -r)
KERNEL_BUILD		:= /lib/modules/$(KERNEL_RELEASE)/build
endif
DESTDIR				:= $(CURDIR)/build
CONFIG_SWTPM		:= m
endif

# module settings
MODULE_NAME				:= kswtpm
obj-$(CONFIG_SWTPM)		+= $(MODULE_NAME).o
$(MODULE_NAME)-y		:= kswtpm-main.o chelp.o

ifeq ($(HELPER), 1)
EXTRA_CFLAGS			+= -DHELPER
$(MODULE_NAME)-y		+= helper.o rpmb.o aes.o
endif


TPM2					:= TPM2.0_v1.37
CRYPTO					:= openssl-1.0.0s

ccflags-y				:= -I$(src)/include

ccflags-y				+= -I$(src)/$(TPM2)/Platform/include/prototypes	\
						   -I$(src)/$(TPM2)/Platform/include	\
						   -I$(src)/$(TPM2)/tpm/include/prototypes	\
					       -I$(src)/$(TPM2)/tpm/include \
					       -I$(src)/$(TPM2)/include

ccflags-y				+= -I$(src)/$(CRYPTO)/include \
					       -I$(src)/$(CRYPTO)/crypto \
					       -I$(src)/$(CRYPTO) \
					       -I$(src)/$(CRYPTO)/crypto/asn1 \
					       -I$(src)/$(CRYPTO)/crypto/evp


# TPM2 Engine

$(MODULE_NAME)-y	+= $(TPM2)/Platform/src/Cancel.o
$(MODULE_NAME)-y	+= $(TPM2)/Platform/src/Clock.o
$(MODULE_NAME)-y	+= $(TPM2)/Platform/src/Entropy.o
$(MODULE_NAME)-y	+= $(TPM2)/Platform/src/LocalityPlat.o
$(MODULE_NAME)-y	+= $(TPM2)/Platform/src/NVMem.o
$(MODULE_NAME)-y	+= $(TPM2)/Platform/src/PPPlat.o
$(MODULE_NAME)-y	+= $(TPM2)/Platform/src/PlatformData.o
$(MODULE_NAME)-y	+= $(TPM2)/Platform/src/PowerPlat.o
$(MODULE_NAME)-y	+= $(TPM2)/Platform/src/RunCommand.o
$(MODULE_NAME)-y	+= $(TPM2)/Platform/src/Unique.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Asymmetric/ECC_Parameters.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Asymmetric/ECDH_KeyGen.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Asymmetric/ECDH_ZGen.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Asymmetric/EC_Ephemeral.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Asymmetric/RSA_Decrypt.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Asymmetric/RSA_Encrypt.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Asymmetric/ZGen_2Phase.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Attestation/Attest_spt.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Attestation/Certify.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Attestation/CertifyCreation.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Attestation/GetCommandAuditDigest.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Attestation/GetSessionAuditDigest.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Attestation/GetTime.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Attestation/Quote.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Capability/GetCapability.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Capability/TestParms.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/ClockTimer/ClockRateAdjust.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/ClockTimer/ClockSet.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/ClockTimer/ReadClock.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/CommandAudit/SetCommandCodeAuditStatus.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Context/ContextLoad.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Context/ContextSave.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Context/Context_spt.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Context/EvictControl.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Context/FlushContext.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/DA/DictionaryAttackLockReset.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/DA/DictionaryAttackParameters.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Duplication/Duplicate.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Duplication/Import.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Duplication/Rewrap.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/EA/PolicyAuthValue.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/EA/PolicyAuthorize.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/EA/PolicyAuthorizeNV.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/EA/PolicyCommandCode.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/EA/PolicyCounterTimer.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/EA/PolicyCpHash.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/EA/PolicyDuplicationSelect.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/EA/PolicyGetDigest.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/EA/PolicyLocality.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/EA/PolicyNV.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/EA/PolicyNameHash.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/EA/PolicyNvWritten.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/EA/PolicyOR.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/EA/PolicyPCR.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/EA/PolicyPassword.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/EA/PolicyPhysicalPresence.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/EA/PolicySecret.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/EA/PolicySigned.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/EA/PolicyTemplate.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/EA/PolicyTicket.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/EA/Policy_spt.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Ecdaa/Commit.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/HashHMAC/EventSequenceComplete.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/HashHMAC/HMAC_Start.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/HashHMAC/HashSequenceStart.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/HashHMAC/SequenceComplete.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/HashHMAC/SequenceUpdate.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Hierarchy/ChangeEPS.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Hierarchy/ChangePPS.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Hierarchy/Clear.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Hierarchy/ClearControl.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Hierarchy/CreatePrimary.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Hierarchy/HierarchyChangeAuth.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Hierarchy/HierarchyControl.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Hierarchy/SetPrimaryPolicy.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Misc/PP_Commands.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Misc/SetAlgorithmSet.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/NVStorage/NV_Certify.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/NVStorage/NV_ChangeAuth.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/NVStorage/NV_DefineSpace.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/NVStorage/NV_Extend.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/NVStorage/NV_GlobalWriteLock.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/NVStorage/NV_Increment.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/NVStorage/NV_Read.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/NVStorage/NV_ReadLock.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/NVStorage/NV_ReadPublic.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/NVStorage/NV_SetBits.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/NVStorage/NV_UndefineSpace.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/NVStorage/NV_UndefineSpaceSpecial.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/NVStorage/NV_Write.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/NVStorage/NV_WriteLock.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/NVStorage/NV_spt.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Object/ActivateCredential.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Object/Create.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Object/CreateLoaded.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Object/Load.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Object/LoadExternal.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Object/MakeCredential.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Object/ObjectChangeAuth.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Object/Object_spt.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Object/ReadPublic.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Object/Unseal.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/PCR/PCR_Allocate.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/PCR/PCR_Event.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/PCR/PCR_Extend.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/PCR/PCR_Read.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/PCR/PCR_Reset.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/PCR/PCR_SetAuthPolicy.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/PCR/PCR_SetAuthValue.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Random/GetRandom.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Random/StirRandom.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Session/PolicyRestart.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Session/StartAuthSession.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Signature/Sign.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Signature/VerifySignature.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Startup/Shutdown.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Startup/Startup.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Symmetric/EncryptDecrypt.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Symmetric/EncryptDecrypt2.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Symmetric/EncryptDecrypt_spt.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Symmetric/HMAC.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Symmetric/Hash.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Testing/GetTestResult.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Testing/IncrementalSelfTest.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Testing/SelfTest.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/command/Vendor/Vendor_TCG_Test.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/crypt/AlgorithmTests.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/crypt/BnConvert.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/crypt/BnEccData.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/crypt/BnMath.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/crypt/BnMemory.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/crypt/CryptDes.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/crypt/CryptEccData.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/crypt/CryptEccKeyExchange.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/crypt/CryptEccMain.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/crypt/CryptEccSignature.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/crypt/CryptHash.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/crypt/CryptHashData.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/crypt/CryptPrime.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/crypt/CryptPrimeSieve.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/crypt/CryptRand.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/crypt/CryptRsa.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/crypt/CryptSelfTest.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/crypt/CryptSym.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/crypt/CryptUtil.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/crypt/CryptUtil.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/crypt/PrimeData.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/crypt/Ticket.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/crypt/ossl/TpmToOsslDesSupport.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/crypt/ossl/TpmToOsslMath.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/crypt/ossl/TpmToOsslSupport.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/events/_TPM_Init.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/main/CommandDispatcher.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/main/ExecCommand.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/main/SessionProcess.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/subsystem/CommandAudit.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/subsystem/DA.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/subsystem/Hierarchy.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/subsystem/NvDynamic.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/subsystem/NvReserved.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/subsystem/Object.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/subsystem/PCR.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/subsystem/PP.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/subsystem/Session.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/subsystem/Time.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/support/AlgorithmCap.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/support/Bits.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/support/CommandCodeAttributes.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/support/Entity.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/support/Global.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/support/Handle.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/support/IoBuffers.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/support/Locality.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/support/Manufacture.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/support/Marshal.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/support/MathOnByteBuffers.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/support/Memory.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/support/Power.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/support/PropertyCap.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/support/Response.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/support/ResponseCodeProcessing.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/support/TpmFail.o
$(MODULE_NAME)-y	+= $(TPM2)/tpm/src/support/TpmSizeChecks.o

# OpenSSL

$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/aes/aes_cbc.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/aes/aes_cfb.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/aes/aes_core.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/aes/aes_ctr.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/aes/aes_ecb.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/aes/aes_ige.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/aes/aes_misc.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/aes/aes_ofb.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/aes/aes_wrap.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/a_bitstr.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/a_bool.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/a_bytes.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/a_d2i_fp.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/a_digest.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/a_dup.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/a_enum.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/a_gentm.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/a_i2d_fp.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/a_int.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/a_mbstr.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/a_object.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/a_octet.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/a_print.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/a_set.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/a_sign.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/a_strex.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/a_strnid.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/a_time.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/a_type.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/a_utctm.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/a_utf8.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/a_verify.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/ameth_lib.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/asn1_err.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/asn1_gen.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/asn1_lib.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/asn1_par.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/asn_mime.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/asn_moid.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/asn_pack.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/bio_asn1.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/bio_ndef.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/d2i_pr.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/d2i_pu.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/evp_asn1.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/f_enum.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/f_int.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/f_string.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/i2d_pr.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/i2d_pu.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/n_pkey.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/nsseq.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/p5_pbe.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/p5_pbev2.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/p8_pkey.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/t_bitst.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/t_crl.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/t_pkey.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/t_req.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/t_spki.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/t_x509.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/t_x509a.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/tasn_dec.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/tasn_enc.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/tasn_fre.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/tasn_new.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/tasn_prn.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/tasn_typ.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/tasn_utl.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/x_algor.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/x_attrib.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/x_bignum.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/x_crl.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/x_exten.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/x_info.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/x_long.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/x_name.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/x_pkey.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/x_pubkey.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/x_req.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/x_sig.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/x_spki.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/x_val.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/x_x509.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/asn1/x_x509a.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/bf/bf_cfb64.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/bf/bf_ecb.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/bf/bf_enc.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/bf/bf_ofb64.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/bf/bf_skey.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/bio/b_dump.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/bio/bf_buff.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/bio/bf_nbio.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/bio/bf_null.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/bio/bio_cb.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/bio/bio_err.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/bio/bio_lib.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/bio/bss_bio.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/bio/bss_mem.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/bio/bss_null.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/bn/bn_add.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/bn/bn_asm.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/bn/bn_blind.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/bn/bn_const.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/bn/bn_ctx.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/bn/bn_depr.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/bn/bn_div.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/bn/bn_err.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/bn/bn_exp.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/bn/bn_exp2.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/bn/bn_gcd.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/bn/bn_gf2m.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/bn/bn_kron.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/bn/bn_lib.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/bn/bn_mod.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/bn/bn_mont.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/bn/bn_mpi.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/bn/bn_mul.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/bn/bn_nist.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/bn/bn_prime.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/bn/bn_print.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/bn/bn_rand.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/bn/bn_recp.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/bn/bn_shift.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/bn/bn_sqr.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/bn/bn_sqrt.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/bn/bn_word.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/buffer/buf_err.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/buffer/buffer.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/cast/c_cfb64.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/cast/c_ecb.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/cast/c_enc.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/cast/c_ofb64.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/cast/c_skey.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/cms/cms_asn1.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/cms/cms_att.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/cms/cms_dd.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/cms/cms_enc.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/cms/cms_env.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/cms/cms_err.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/cms/cms_io.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/cms/cms_lib.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/cms/cms_sd.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/comp/c_rle.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/comp/c_zlib.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/comp/comp_err.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/comp/comp_lib.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/conf/conf_api.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/conf/conf_def.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/conf/conf_err.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/conf/conf_lib.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/conf/conf_mall.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/conf/conf_mod.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/cpt_err.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/cryptlib.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/des/cbc_cksm.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/des/cbc_enc.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/des/cfb64ede.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/des/cfb64enc.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/des/cfb_enc.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/des/des_enc.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/des/ecb3_enc.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/des/ecb_enc.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/des/ede_cbcm_enc.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/des/ofb64ede.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/des/ofb64enc.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/des/ofb_enc.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/des/pcbc_enc.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/des/qud_cksm.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/des/rand_key.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/des/read2pwd.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/des/rpc_enc.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/des/set_key.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/des/str2key.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/des/xcbc_enc.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/dh/dh_ameth.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/dh/dh_asn1.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/dh/dh_check.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/dh/dh_depr.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/dh/dh_err.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/dh/dh_gen.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/dh/dh_key.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/dh/dh_lib.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/dh/dh_pmeth.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/dsa/dsa_ameth.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/dsa/dsa_asn1.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/dsa/dsa_depr.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/dsa/dsa_err.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/dsa/dsa_gen.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/dsa/dsa_key.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/dsa/dsa_lib.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/dsa/dsa_ossl.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/dsa/dsa_pmeth.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/dsa/dsa_sign.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/dsa/dsa_vrf.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/dso/dso_dl.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/dso/dso_dlfcn.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/dso/dso_err.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/dso/dso_lib.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/dso/dso_null.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/dso/dso_openssl.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/ebcdic.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/ec/ec2_mult.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/ec/ec2_smpl.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/ec/ec_ameth.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/ec/ec_asn1.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/ec/ec_check.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/ec/ec_curve.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/ec/ec_cvt.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/ec/ec_err.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/ec/ec_key.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/ec/ec_lib.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/ec/ec_mult.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/ec/ec_pmeth.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/ec/ec_print.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/ec/eck_prn.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/ec/ecp_mont.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/ec/ecp_nist.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/ec/ecp_smpl.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/ecdh/ech_err.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/ecdh/ech_key.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/ecdh/ech_lib.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/ecdh/ech_ossl.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/ecdsa/ecs_asn1.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/ecdsa/ecs_err.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/ecdsa/ecs_lib.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/ecdsa/ecs_ossl.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/ecdsa/ecs_sign.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/ecdsa/ecs_vrf.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/err/err.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/err/err_all.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/err/err_prn.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/bio_b64.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/bio_enc.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/bio_md.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/bio_ok.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/c_all.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/c_allc.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/c_alld.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/digest.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/e_aes.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/e_bf.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/e_cast.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/e_des.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/e_des3.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/e_idea.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/e_null.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/e_old.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/e_rc2.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/e_rc4.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/e_rc5.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/e_xcbc_d.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/encode.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/evp_enc.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/evp_err.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/evp_key.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/evp_lib.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/evp_pbe.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/evp_pkey.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/m_dss.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/m_dss1.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/m_ecdsa.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/m_md2.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/m_md4.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/m_md5.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/m_null.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/m_ripemd.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/m_sha.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/m_sha1.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/m_sigver.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/m_wp.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/names.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/p5_crpt.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/p5_crpt2.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/p_dec.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/p_enc.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/p_lib.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/p_open.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/p_seal.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/p_sign.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/p_verify.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/pmeth_fn.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/pmeth_gn.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/evp/pmeth_lib.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/ex_data.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/hmac/hm_ameth.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/hmac/hm_pmeth.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/hmac/hmac.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/idea/i_cbc.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/idea/i_cfb64.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/idea/i_ecb.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/idea/i_ofb64.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/idea/i_skey.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/krb5/krb5_asn.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/lhash/lh_stats.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/lhash/lhash.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/md4/md4_dgst.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/md4/md4_one.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/md5/md5_dgst.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/md5/md5_one.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/mem.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/mem_clr.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/mem_dbg.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/modes/cbc128.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/modes/cfb128.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/modes/ctr128.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/modes/ofb128.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/o_time.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/objects/o_names.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/objects/obj_dat.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/objects/obj_err.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/objects/obj_lib.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/objects/obj_xref.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/ocsp/ocsp_asn.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/ocsp/ocsp_cl.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/ocsp/ocsp_err.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/ocsp/ocsp_ext.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/ocsp/ocsp_ht.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/ocsp/ocsp_lib.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/ocsp/ocsp_prn.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/ocsp/ocsp_srv.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/ocsp/ocsp_vfy.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/pem/pem_all.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/pem/pem_err.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/pem/pem_info.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/pem/pem_lib.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/pem/pem_oth.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/pem/pem_pk8.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/pem/pem_pkey.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/pem/pem_seal.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/pem/pem_sign.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/pem/pem_x509.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/pem/pem_xaux.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/pkcs12/p12_add.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/pkcs12/p12_asn.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/pkcs12/p12_attr.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/pkcs12/p12_crpt.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/pkcs12/p12_crt.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/pkcs12/p12_decr.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/pkcs12/p12_init.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/pkcs12/p12_key.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/pkcs12/p12_kiss.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/pkcs12/p12_mutl.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/pkcs12/p12_npas.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/pkcs12/p12_p8d.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/pkcs12/p12_p8e.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/pkcs12/p12_utl.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/pkcs12/pk12err.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/pkcs7/pk7_asn1.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/pkcs7/pk7_attr.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/pkcs7/pk7_doit.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/pkcs7/pk7_lib.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/pkcs7/pk7_mime.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/pkcs7/pk7_smime.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/pkcs7/pkcs7err.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/pqueue/pqueue.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/rand/md_rand.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/rand/rand_err.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/rand/rand_lib.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/rand/rand_nw.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/rc2/rc2_cbc.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/rc2/rc2_ecb.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/rc2/rc2_skey.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/rc2/rc2cfb64.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/rc2/rc2ofb64.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/rc4/rc4_enc.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/rc4/rc4_skey.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/ripemd/rmd_dgst.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/ripemd/rmd_one.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/rsa/rsa_ameth.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/rsa/rsa_asn1.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/rsa/rsa_chk.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/rsa/rsa_depr.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/rsa/rsa_eay.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/rsa/rsa_err.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/rsa/rsa_gen.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/rsa/rsa_lib.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/rsa/rsa_none.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/rsa/rsa_null.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/rsa/rsa_oaep.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/rsa/rsa_pk1.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/rsa/rsa_pmeth.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/rsa/rsa_pss.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/rsa/rsa_saos.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/rsa/rsa_sign.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/rsa/rsa_ssl.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/rsa/rsa_x931.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/sha/sha1_one.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/sha/sha1dgst.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/sha/sha256.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/sha/sha512.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/sha/sha_dgst.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/sha/sha_one.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/stack/stack.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/ts/ts_err.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/txt_db/txt_db.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/ui/ui_compat.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/ui/ui_err.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/ui/ui_lib.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/ui/ui_openssl.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/ui/ui_util.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/whrlpool/wp_block.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/whrlpool/wp_dgst.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509/by_file.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509/x509_att.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509/x509_cmp.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509/x509_d2.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509/x509_def.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509/x509_err.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509/x509_ext.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509/x509_lu.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509/x509_obj.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509/x509_r2x.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509/x509_req.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509/x509_set.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509/x509_trs.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509/x509_txt.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509/x509_v3.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509/x509_vfy.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509/x509_vpm.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509/x509cset.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509/x509name.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509/x509rset.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509/x509spki.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509/x509type.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509/x_all.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509v3/pcy_cache.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509v3/pcy_data.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509v3/pcy_lib.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509v3/pcy_map.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509v3/pcy_node.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509v3/pcy_tree.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509v3/v3_addr.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509v3/v3_akey.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509v3/v3_akeya.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509v3/v3_alt.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509v3/v3_asid.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509v3/v3_bcons.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509v3/v3_bitst.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509v3/v3_conf.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509v3/v3_cpols.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509v3/v3_crld.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509v3/v3_enum.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509v3/v3_extku.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509v3/v3_genn.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509v3/v3_ia5.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509v3/v3_info.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509v3/v3_int.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509v3/v3_lib.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509v3/v3_ncons.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509v3/v3_ocsp.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509v3/v3_pci.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509v3/v3_pcia.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509v3/v3_pcons.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509v3/v3_pku.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509v3/v3_pmaps.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509v3/v3_prn.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509v3/v3_purp.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509v3/v3_skey.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509v3/v3_sxnet.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509v3/v3_utl.o
$(MODULE_NAME)-y	+= $(CRYPTO)/crypto/x509v3/v3err.o


all:
	@$(MAKE) -C $(KERNEL_BUILD) M=$(CURDIR) modules

clean:
	@$(MAKE) -C $(KERNEL_BUILD) M=$(CURDIR) clean
	@rm -f Modules.symvers kswtpm.rules

TPM_GROUP			?= tss
INSTALL				?= install

kswtpm.rules: kswtpm.rules.in
	@sed -e "s/\$$TPM_GROUP/$(TPM_GROUP)/g" kswtpm.rules.in > kswtpm.rules

install: kswtpm.rules
	@$(MAKE) -C $(KERNEL_BUILD) M=$(CURDIR) INSTALL_MOD_PATH=$(DESTDIR) modules_install
	@$(INSTALL) -m 644 -D kswtpm.rules $(DESTDIR)/etc/udev/rules.d/80-kswtpm.rules

.PHONY: all clean install

